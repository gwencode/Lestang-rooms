<div class="container-fluid container background-back-link">
  <%= link_to raw("<i class='fa-solid fa-arrow-left-long'></i> <span>Retour</span>"), :back, class: "back-link" %>
</div>

<div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)), url('<%= asset_path("#{@room.name}.png") %>')">

  <div class="container">
    <div class="py-3" style="background-color: rgba(0, 0, 0, 0.6); position: relative;">

      <h2 class="px-1">Créneaux de <%= @room.name.downcase %></h2>

      <div class="px-3">

        <div class="row">
          <% @slots.each do |slot| %>
            <div class="col-12 col-md-6 py-2">
              <%= link_to edit_admin_room_slot_path(@room, slot), class: "text-decoration-none" do %>
                <div>
                  <h4 class="text-white m-0"><%= l(slot.start_date, format: "%d %B") %> <span style="font-size: 0.5em">aprem</span> - <%= l(slot.end_date, format: "%d %B %Y") %> <span style="font-size: 0.5em">matin</span></h4>
                  <% notice = @room == Room.last && slot.start_date.hour == 14 ? "- maison disponible" : ""  %>
                  <p class="m-0 <%= slot.available ? "text-success" : "text-warning" %>"><%= slot.available ? "Disponible" : "Indisponible" %> <span class="text-success" style="font-size: 0.8em"><%= notice %></span></p>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>

        <div class="text-center py-3">
          <h5 class="m-0"><%= link_to "Nouveau créneau", new_admin_room_slot_path(@room), class: "button-blue" %></h5>
        </div>


      </div>

      <div class="separator"></div>

      <div class="p-3">
        <%= simple_form_for([@room, @booking],
                            url: room_bookings_path(@room),
                            method: :post,
                            data: { controller: 'flatpickr-admin',
                                    flatpickr_admin_arrivals_disabled_value: @room.arrivals_disabled,
                                    flatpickr_admin_departures_disabled_value: @room.departures_disabled,
                                    flatpickr_admin_default_available_slots_value: @room.default_available_slots,
                                    flatpickr_admin_arrivals_enabled_value: @room.arrivals_enabled,
                                    flatpickr_admin_departures_enabled_value: @room.departures_enabled,
                                    flatpickr_admin_available_days_value: @room.available_days }) do |f| %>
          <h3 class="text-white text-center">Disponibilités</h3>
          <div class="row">

            <div class="col-12 col-md-6 text-center">
              <%= f.input :arrival, as: :string, label: "Arrivée", label_html: { class: "fw-bold text-white" }, required: false,
                input_html: { data:
                {
                  flatpickr_admin_target: "startTime"
                },
                class: "d-none"
              } %>
            </div>

            <div class="col-12 col-md-6 text-center">
              <%= f.input :departure, as: :string, label: "Départ", label_html: { class: "fw-bold text-white" }, required: false,
                input_html: { data:
                  {
                    flatpickr_admin_target: "endTime",
                  },
                  class: "d-none"
                }
              %>
            </div>

          </div>

        <% end %>
      </div>

      <div class="separator"></div>

      <% other_room = @room == Room.first ? Room.last : Room.first%>
      <div class="text-center py-3">
        <%= link_to "Voir les créneaux de #{other_room.name.downcase}", admin_room_slots_path(other_room), class: "text-white fst-italic" %>
      </div>

    </div>
  </div>

</div>
